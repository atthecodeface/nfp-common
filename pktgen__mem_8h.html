<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NFP Example Software: /home/nfp/gavin/nfp-common/host/src/pktgen_mem.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NFP Example Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4f7e4242e27b8c8b476722507617a881.html">host</a></li><li class="navelem"><a class="el" href="dir_ee436fe9bbd694a1f99c2ca92ae2568f.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pktgen_mem.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Packet generator memory support.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
</div>
<p><a href="pktgen__mem_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpktgen__mem__data.html">pktgen_mem_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpktgen__mem__alloc__hints.html">pktgen_mem_alloc_hints</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a94028f171314d8442f56be63b6043aab"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#a94028f171314d8442f56be63b6043aab">pktgen_mem_load_callback</a> )(void *handle, struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *layout, struct <a class="el" href="structpktgen__mem__data.html">pktgen_mem_data</a> *data)</td></tr>
<tr class="separator:a94028f171314d8442f56be63b6043aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b5b45ae14f5c491340dcd4a67b0a11"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#ad4b5b45ae14f5c491340dcd4a67b0a11">pktgen_mem_alloc_callback</a> )(void *handle, uint64_t size, uint64_t min_break_size, int memory_mask, struct <a class="el" href="structpktgen__mem__data.html">pktgen_mem_data</a> *data)</td></tr>
<tr class="separator:ad4b5b45ae14f5c491340dcd4a67b0a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:adc29c2ff13d900c2f185ee95427fb06c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <b>PKTGEN_ALLOC_HINT_END</b> =0, 
<b>PKTGEN_ALLOC_HINT_BALANCE_PACKETS</b>
 }</td></tr>
<tr class="separator:adc29c2ff13d900c2f185ee95427fb06c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6cc0cc158587bb5f75049bac8ec1a0e3"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#a6cc0cc158587bb5f75049bac8ec1a0e3">pktgen_mem_alloc</a> (void *handle, <a class="el" href="pktgen__mem_8h.html#ad4b5b45ae14f5c491340dcd4a67b0a11">pktgen_mem_alloc_callback</a> alloc_callback, <a class="el" href="pktgen__mem_8h.html#a94028f171314d8442f56be63b6043aab">pktgen_mem_load_callback</a> load_callback, struct <a class="el" href="structpktgen__mem__alloc__hints.html">pktgen_mem_alloc_hints</a> *alloc_hints)</td></tr>
<tr class="separator:a6cc0cc158587bb5f75049bac8ec1a0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f8ab7ac05c36671276442b7f6474ead"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#a8f8ab7ac05c36671276442b7f6474ead">pktgen_mem_open_directory</a> (struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *layout, const char *dirname)</td></tr>
<tr class="separator:a8f8ab7ac05c36671276442b7f6474ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8034e19fae8d2cfd90e8b162328a06e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#a8034e19fae8d2cfd90e8b162328a06e9">pktgen_mem_load</a> (struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *layout)</td></tr>
<tr class="separator:a8034e19fae8d2cfd90e8b162328a06e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130b21341d50b0faae573c40cc8bf86d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#a130b21341d50b0faae573c40cc8bf86d">pktgen_mem_close</a> (struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *layout)</td></tr>
<tr class="separator:a130b21341d50b0faae573c40cc8bf86d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2249c01686bff7dfe5b088935c06b490"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__mem_8h.html#a2249c01686bff7dfe5b088935c06b490">pktgen_mem_get_mu</a> (struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *layout, int region, uint64_t ofs)</td></tr>
<tr class="separator:a2249c01686bff7dfe5b088935c06b490"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Packet generator memory support. </p>
<p>Copyright (C) 2015, Gavin J Stark. All rights reserved.</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>This set of library functions supports the packet generator firmware and its memory initialization. It provides functions for loading and populating the NFP memories as required by the packet generator firmware.</p>
<p>The memory layout consists of a schedule, a set of scripts, and regions of packet data.</p>
<p>The schedule contains sets of flow-packet entries, each entry of which contains a transmit time, packet MU address (including island), length, flags and a script offset.</p>
<p>The file/data to be loaded consists of a schedule file, a script file, and at least one packet data file.</p>
<p>The loading process requires allocation of the NFP memory, and fixing-up of packet addresses from the schedule to match the actual memory addresss of packet data. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ad4b5b45ae14f5c491340dcd4a67b0a11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* pktgen_mem_alloc_callback)(void *handle, uint64_t size, uint64_t min_break_size, int memory_mask, struct <a class="el" href="structpktgen__mem__data.html">pktgen_mem_data</a> *data)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_alloc_callback </p>

</div>
</div>
<a class="anchor" id="a94028f171314d8442f56be63b6043aab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* pktgen_mem_load_callback)(void *handle, struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *layout, struct <a class="el" href="structpktgen__mem__data.html">pktgen_mem_data</a> *data)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_load_callback </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="adc29c2ff13d900c2f185ee95427fb06c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structpktgen__mem__alloc__hints.html">pktgen_mem_alloc_hints</a> hint types </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6cc0cc158587bb5f75049bac8ec1a0e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a>* pktgen_mem_alloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pktgen__mem_8h.html#ad4b5b45ae14f5c491340dcd4a67b0a11">pktgen_mem_alloc_callback</a>&#160;</td>
          <td class="paramname"><em>alloc_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pktgen__mem_8h.html#a94028f171314d8442f56be63b6043aab">pktgen_mem_load_callback</a>&#160;</td>
          <td class="paramname"><em>load_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpktgen__mem__alloc__hints.html">pktgen_mem_alloc_hints</a> *&#160;</td>
          <td class="paramname"><em>alloc_hints</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_alloc</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle for callbacks </td></tr>
    <tr><td class="paramname">alloc_callback</td><td>Callback invoked to allocate MU for a structure </td></tr>
    <tr><td class="paramname">load_callback</td><td>Callback invoked to load data into the NFP </td></tr>
    <tr><td class="paramname">alloc_hints</td><td>Allocation hint array used to split up packet data</td></tr>
  </table>
  </dd>
</dl>
<p>Return an allocated memory layout</p>
<p>Allocate a packet generator memory layout structure</p>
<p>pktgen_mem_alloc</p>
<p>Allocate a packet generator memory layout structure</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle for callbacks </td></tr>
    <tr><td class="paramname">alloc_callback</td><td>Callback invoked to allocate MU for a structure </td></tr>
    <tr><td class="paramname">load_callback</td><td>Callback invoked to load data into the NFP </td></tr>
    <tr><td class="paramname">alloc_hints</td><td>Allocation hint array used to split up packet data</td></tr>
  </table>
  </dd>
</dl>
<p>Return an allocated memory layout </p>

</div>
</div>
<a class="anchor" id="a130b21341d50b0faae573c40cc8bf86d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_mem_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *&#160;</td>
          <td class="paramname"><em>layout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_close</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layout</td><td>Memory layout previously allocated</td></tr>
  </table>
  </dd>
</dl>
<p>Close and free a packet generator memory layout</p>
<p>pktgen_mem_close</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layout</td><td>Memory layout previously allocated</td></tr>
  </table>
  </dd>
</dl>
<p>Close and deallocate a layout </p>

</div>
</div>
<a class="anchor" id="a2249c01686bff7dfe5b088935c06b490"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t pktgen_mem_get_mu </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *&#160;</td>
          <td class="paramname"><em>layout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>ofs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_get_mu</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layout</td><td>Memory layout previously allocated </td></tr>
    <tr><td class="paramname">region</td><td>Memory region number to find mu_base of </td></tr>
    <tr><td class="paramname">ofs</td><td>Offset into region to find mu_base of</td></tr>
  </table>
  </dd>
</dl>
<p>Return the MU address of the offset in the region</p>
<p>pktgen_mem_get_mu </p>

</div>
</div>
<a class="anchor" id="a8034e19fae8d2cfd90e8b162328a06e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pktgen_mem_load </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *&#160;</td>
          <td class="paramname"><em>layout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_load</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layout</td><td>Memory layout previously allocated</td></tr>
  </table>
  </dd>
</dl>
<p>Allocate memory required for the layout, and load memory onto the NFP </p>

</div>
</div>
<a class="anchor" id="a8f8ab7ac05c36671276442b7f6474ead"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pktgen_mem_open_directory </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpktgen__mem__layout.html">pktgen_mem_layout</a> *&#160;</td>
          <td class="paramname"><em>layout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_mem_open_directory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layout</td><td>Memory layout previously allocated </td></tr>
    <tr><td class="paramname">dirname</td><td>Directory with the schedule, script and packet data</td></tr>
  </table>
  </dd>
</dl>
<p>Returns 0 on success, non-zero on error</p>
<p>Open a packet generator memory contents directory, and determine the memory requirements for it</p>
<p>pktgen_mem_open_directory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layout</td><td>Memory layout previously allocated </td></tr>
    <tr><td class="paramname">dirname</td><td>Directory name containing files to load</td></tr>
  </table>
  </dd>
</dl>
<p>Returns 0 on success, non-zero on error</p>
<p>Open a packet generator memory contents directory, and determine the NFP memory requirements for it </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 20 2016 15:36:17 for NFP Example Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
