<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NFP Example Software: /home/nfp/gavin/nfp-common/firmware/app/pktgen_lib.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NFP Example Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="dir_73d8daca1cbf5b0779bcb86e18cd3f5d.html">app</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pktgen_lib.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A packet generator library for pktgen application.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="me_8h_source.html">nfp/me.h</a>&gt;</code><br/>
<code>#include &lt;nfp/mem.h&gt;</code><br/>
<code>#include &lt;nfp/cls.h&gt;</code><br/>
<code>#include &lt;nfp/pcie.h&gt;</code><br/>
<code>#include &lt;nfp.h&gt;</code><br/>
<code>#include &lt;nfp_override.h&gt;</code><br/>
<code>#include &quot;pktgen_lib.h&quot;</code><br/>
<code>#include &quot;firmware/pktgen.h&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtx__pkt__work.html">tx_pkt_work</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbatch__work.html">batch_work</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtx__seq.html">tx_seq</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbatch__desc.html">batch_desc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscript.html">script</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscript__finish.html">script_finish</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa973b88320b1063ed0a0355efaaa8e2f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#aa973b88320b1063ed0a0355efaaa8e2f">MAX_BATCH_ITEMS_IN_PROCESSING</a>&#160;&#160;&#160;(32)</td></tr>
<tr class="separator:aa973b88320b1063ed0a0355efaaa8e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa632d755a4f99e310c6f057c5af93227"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#aa632d755a4f99e310c6f057c5af93227">PKTGEN_CLS_HOST_ADDRESS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:aa632d755a4f99e310c6f057c5af93227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10ddd7a9f6794e96e08e61de773b7f7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab10ddd7a9f6794e96e08e61de773b7f7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ALLOC_PKTGEN_HOST</b>()&#160;&#160;&#160;0</td></tr>
<tr class="separator:ab10ddd7a9f6794e96e08e61de773b7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0429b7bb03eb3c09ae23eef58a4a88d4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0429b7bb03eb3c09ae23eef58a4a88d4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ALLOC_PKTGEN_RING</b>()&#160;&#160;&#160;0</td></tr>
<tr class="separator:a0429b7bb03eb3c09ae23eef58a4a88d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972cdc1b3b2f231fc16b7b10bde5cb6e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a972cdc1b3b2f231fc16b7b10bde5cb6e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ALLOC_PKTGEN_DEBUG</b>()&#160;&#160;&#160;(__cls void *)__alloc_resource(&quot;pktgen_cls_debug pktgen_cls_debug island 64&quot;)</td></tr>
<tr class="separator:a972cdc1b3b2f231fc16b7b10bde5cb6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d47a93ca47a6d2d083bdc5449c4c9cd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9d47a93ca47a6d2d083bdc5449c4c9cd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_WORK</b>&#160;&#160;&#160;pktgen_mu_workq_batch_work,10,40,i24.emem</td></tr>
<tr class="separator:a9d47a93ca47a6d2d083bdc5449c4c9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01afccfe12bb02668589e359edcc6ee3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a01afccfe12bb02668589e359edcc6ee3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_0</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_0,10,32,i24.emem</td></tr>
<tr class="separator:a01afccfe12bb02668589e359edcc6ee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb8825ec417eafbf591b92e69fc2f72e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeb8825ec417eafbf591b92e69fc2f72e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_1</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_1,10,33,i24.emem</td></tr>
<tr class="separator:aeb8825ec417eafbf591b92e69fc2f72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0bf175f62e49c0786a3b4e95664e464"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac0bf175f62e49c0786a3b4e95664e464"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_2</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_2,10,34,i24.emem</td></tr>
<tr class="separator:ac0bf175f62e49c0786a3b4e95664e464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bbdf424f16777533256617cc51cf5de"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0bbdf424f16777533256617cc51cf5de"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_3</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_3,10,35,i24.emem</td></tr>
<tr class="separator:a0bbdf424f16777533256617cc51cf5de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b0d8c08eef1b487325d95a47cdc5caf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4b0d8c08eef1b487325d95a47cdc5caf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_4</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_4,10,36,i24.emem</td></tr>
<tr class="separator:a4b0d8c08eef1b487325d95a47cdc5caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99999a30ec845900bf50461ee3e50d73"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a99999a30ec845900bf50461ee3e50d73"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_5</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_5,10,37,i24.emem</td></tr>
<tr class="separator:a99999a30ec845900bf50461ee3e50d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2476dc324a372ea92e613c1f77c77e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2476dc324a372ea92e613c1f77c77e1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_6</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_6,10,38,i24.emem</td></tr>
<tr class="separator:ac2476dc324a372ea92e613c1f77c77e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a653990ca28a5fb7833df594209bf0f6e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a653990ca28a5fb7833df594209bf0f6e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QDEF_BATCH_DESC_7</b>&#160;&#160;&#160;pktgen_mu_workq_batch_desc_7,10,39,i24.emem</td></tr>
<tr class="separator:a653990ca28a5fb7833df594209bf0f6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a222f2b093f2f4ecaff3614f228d44a6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a222f2b093f2f4ecaff3614f228d44a6a">CTM_ALLOC_256B</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a222f2b093f2f4ecaff3614f228d44a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a948a44aa76b2ff5c6d09dff29fcd77ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a948a44aa76b2ff5c6d09dff29fcd77ed">CLS_DEBUG_JOURNAL_RING</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a948a44aa76b2ff5c6d09dff29fcd77ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1785206ad78ce27528d134fc0b953652"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a1785206ad78ce27528d134fc0b953652">MAX_PKTS_IN_PROGRESS</a>&#160;&#160;&#160;(32)</td></tr>
<tr class="separator:a1785206ad78ce27528d134fc0b953652"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac2033c71b36de0b0da2992b38b86af72"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#ac2033c71b36de0b0da2992b38b86af72">_alloc_mem</a> (&quot;pktgen_cls_debug_res cls island 64 64&quot;)</td></tr>
<tr class="separator:ac2033c71b36de0b0da2992b38b86af72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c74505d381281a7046646fd366f788d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a6c74505d381281a7046646fd366f788d">__declspec</a> (shared)</td></tr>
<tr class="separator:a6c74505d381281a7046646fd366f788d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae623cf629f05a9ce24db9aeaeeb20736"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae623cf629f05a9ce24db9aeaeeb20736"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>tx_slave_alloc_pkt</b> (struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *<a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a>)</td></tr>
<tr class="separator:ae623cf629f05a9ce24db9aeaeeb20736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec85d5f9d2e8c647391fdbbe290b874e"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#aec85d5f9d2e8c647391fdbbe290b874e">tx_slave_read_script_start</a> (struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *<a class="el" href="structtx__pkt__work.html">tx_pkt_work</a>, __xread struct <a class="el" href="structscript.html">script</a> *<a class="el" href="structscript.html">script</a>, SIGNAL *sig)</td></tr>
<tr class="separator:aec85d5f9d2e8c647391fdbbe290b874e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a500847c5a7c700fcce6c35b72c4dc1eb"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a500847c5a7c700fcce6c35b72c4dc1eb">tx_slave_dma_pkt_start</a> (struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *<a class="el" href="structtx__pkt__work.html">tx_pkt_work</a>, struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *<a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a>, SIGNAL *sig)</td></tr>
<tr class="separator:a500847c5a7c700fcce6c35b72c4dc1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af78a027a64fb0135b14aba5a016d0031"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af78a027a64fb0135b14aba5a016d0031"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>tx_slave_pkt_tx</b> (struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *<a class="el" href="structtx__pkt__work.html">tx_pkt_work</a>, struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *<a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a>)</td></tr>
<tr class="separator:af78a027a64fb0135b14aba5a016d0031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69f9e3d755de60c1a7bba51e3dfa5e6"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#af69f9e3d755de60c1a7bba51e3dfa5e6">tx_slave_script_start_write_hdr</a> (uint32_t pkt_addr, __xwrite uint32_t *hdr, __xwrite uint32_t *mod)</td></tr>
<tr class="separator:af69f9e3d755de60c1a7bba51e3dfa5e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dac39f00a089415ad9fc306c0da6544"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5dac39f00a089415ad9fc306c0da6544"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>tx_slave_script_start</b> (struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *<a class="el" href="structtx__pkt__work.html">tx_pkt_work</a>, struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *<a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a>, __xread struct <a class="el" href="structscript.html">script</a> *<a class="el" href="structscript.html">script</a>, __xwrite struct <a class="el" href="structscript__finish.html">script_finish</a> *<a class="el" href="structscript__finish.html">script_finish</a>)</td></tr>
<tr class="separator:a5dac39f00a089415ad9fc306c0da6544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69554b8c1126bf1d6de052cb135ad688"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a69554b8c1126bf1d6de052cb135ad688">tx_slave_script_finish</a> (struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *<a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a>, __xwrite struct <a class="el" href="structscript__finish.html">script_finish</a> *<a class="el" href="structscript__finish.html">script_finish</a>)</td></tr>
<tr class="separator:a69554b8c1126bf1d6de052cb135ad688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7640d85c7685a7c0f86f10bbea0d2b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#af7640d85c7685a7c0f86f10bbea0d2b5">tx_slave_wait_for_tx_time</a> (struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *<a class="el" href="structtx__pkt__work.html">tx_pkt_work</a>)</td></tr>
<tr class="separator:af7640d85c7685a7c0f86f10bbea0d2b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac150555ef2cb8be4260d94c7b33a24e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#ac150555ef2cb8be4260d94c7b33a24e8">pktgen_tx_slave</a> (void)</td></tr>
<tr class="separator:ac150555ef2cb8be4260d94c7b33a24e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008f7e575456583ff8bb94fe667157f3"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a008f7e575456583ff8bb94fe667157f3">batch_dist_add_pkt_to_batch</a> (struct <a class="el" href="structbatch__work.html">batch_work</a> *<a class="el" href="structbatch__work.html">batch_work</a>, __xread struct pktgen_sched_entry *sched_entry, __xwrite struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *tx_pkt_work_out, int i, SIGNAL *sig)</td></tr>
<tr class="separator:a008f7e575456583ff8bb94fe667157f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55bb011c6b0189b120d7ae547f89d307"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a55bb011c6b0189b120d7ae547f89d307">batch_dist_distribute_sched_entries</a> (struct <a class="el" href="structbatch__work.html">batch_work</a> *<a class="el" href="structbatch__work.html">batch_work</a>, __xread struct pktgen_sched_entry sched_entries[8])</td></tr>
<tr class="separator:a55bb011c6b0189b120d7ae547f89d307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb2375c2877e4eb5b842b6043d5ce2d"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#aceb2375c2877e4eb5b842b6043d5ce2d">batch_dist_get_batch_work</a> (struct <a class="el" href="structbatch__work.html">batch_work</a> *<a class="el" href="structbatch__work.html">batch_work</a>)</td></tr>
<tr class="separator:aceb2375c2877e4eb5b842b6043d5ce2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86003c48e3ec4169a8899e8945dcbdb3"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a86003c48e3ec4169a8899e8945dcbdb3">batch_dist_get_sched_entries</a> (struct <a class="el" href="structbatch__work.html">batch_work</a> *<a class="el" href="structbatch__work.html">batch_work</a>, __xread struct pktgen_sched_entry sched_entries[8])</td></tr>
<tr class="separator:a86003c48e3ec4169a8899e8945dcbdb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e056ba602dcac1e065468a1cd62d97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a39e056ba602dcac1e065468a1cd62d97">pktgen_batch_distributor</a> (void)</td></tr>
<tr class="separator:a39e056ba602dcac1e065468a1cd62d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad59556224ecabf28aa73f9c0755663"><td class="memItemLeft" align="right" valign="top">__intrinsic void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#adad59556224ecabf28aa73f9c0755663">tx_master_add_batch_work</a> (struct <a class="el" href="structbatch__work.html">batch_work</a> *<a class="el" href="structbatch__work.html">batch_work</a>)</td></tr>
<tr class="separator:adad59556224ecabf28aa73f9c0755663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c6e320cf36a24808574a07e5d699c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#ab4c6e320cf36a24808574a07e5d699c7">pktgen_master</a> (void)</td></tr>
<tr class="separator:ab4c6e320cf36a24808574a07e5d699c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b23f6d5b14315cbc8b9fe485b16d9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a40b23f6d5b14315cbc8b9fe485b16d9e">pktgen_master_init</a> (void)</td></tr>
<tr class="separator:a40b23f6d5b14315cbc8b9fe485b16d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2c22e9b35c5f7082268fcc50da8523"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a3e2c22e9b35c5f7082268fcc50da8523">pktgen_batch_distributor_init</a> (void)</td></tr>
<tr class="separator:a3e2c22e9b35c5f7082268fcc50da8523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ad78e70b8a77076b4eddbfabf4870b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktgen__lib_8c.html#a75ad78e70b8a77076b4eddbfabf4870b">pktgen_tx_slave_init</a> (int batch)</td></tr>
<tr class="separator:a75ad78e70b8a77076b4eddbfabf4870b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A packet generator library for pktgen application. </p>
<p>Copyright (C) 2015, Gavin J Stark. All rights reserved.</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>This is a library to support a packet generator using a host x86 system to supply scripted packet generation </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a948a44aa76b2ff5c6d09dff29fcd77ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLS_DEBUG_JOURNAL_RING&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_pkt_tx</p>
<p>10i </p>

</div>
</div>
<a class="anchor" id="a222f2b093f2f4ecaff3614f228d44a6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CTM_ALLOC_256B&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_alloc_pkt</p>
<p>8i+300 + poll if required</p>
<p>Allocate a 256B CTM packet buffer </p>

</div>
</div>
<a class="anchor" id="aa973b88320b1063ed0a0355efaaa8e2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_BATCH_ITEMS_IN_PROCESSING&#160;&#160;&#160;(32)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Outline of code</p>
<p>The host delivers basic packets into the MU at 2kB+64 alignments, or if the packets are &lt;192B to a 256B+64B alignment.</p>
<p>The host delivers a set of 'flow' descriptors, or scripts. These are a set of scripts that are combined with a basic packet to form a packet for transmission.</p>
<p>The host also delivers a schedule, or stream of batches of flow-packets, to transmit. Each batch is 8 flow-packet entries. Each flow-packet entry in a batch is a packet address+length, a script offset, and a time (in ns) at which to transmit the packet.</p>
<p>Each flow-packet entry is 16B. uint32_t tx_time_lo; unsigned int tx_time_hi:8; uint32_t mu_base_s8; unsigned int script_ofs:24; unsigned int length:16; unsigned int flags:16;</p>
<p>The stream is executed by a master thread that distributes a basic time, a batch sequence number and a tx sequence order number to a set of batch distributor threads. The master thread keeps track of how many packets have completed processing using global memory locations (one per batch, incremented upon completion of tx by packets processing by TX slave transmitters). The master thread can then hold off adding work to the batch queues to stop the downstream work queues from overflowing.</p>
<p>The batch distributor threads take the batch sequence number, base time and tx sequence order and read in the 8 flow-packet entries for their batch. They add each entry as TX slave work items to the work queue for each batch (each batch has a work queue). In this way the work queue for a batch has at most 1/8th of the packet rate added to it per second (limiting the MU queue engine stress on that QA to &lt;10Mops for 40GbE).</p>
<p>A work item for the TX slave transmitter added by the batch distributors is: </p>
<pre class="fragment">uint32_t     tx_time_lo;
unsigned int tx_time_hi:8;
unsigned int script_ofs:24;
uint32_t     mu_base_s8;
unsigned int length:16;
unsigned int tx_seq:16;
</pre><p> A length of 0 implies no packet (and <a class="el" href="structtx__seq.html">tx_seq</a> is unused)</p>
<p>The TX slave transmitter performs the following steps:</p>
<p>1) Wait for permission to progress within the batch (in range say 1024 'in the future' tx seq) 2) Alloc 3) Start DMA from MU to CTM (first &lt;192B) 4) Start script read 5) Write header 6) Wait for DMA completion 7) Overwrite DMA data 8) Wait time 9) Tx sequence 10) Increment global batch 'ready' indicator</p>
<p>Each batch has a 'total released' claimant globally As a worker on a batch item, you can only start if the work item's transmit sequence number is &lt; 'last transmitted' + FIXED_N When the NBI BLM is done transmitting the buffer recycling can update 'last transmitted'</p>
<p>CTM credit has to be handled per-CTM in hardware. 256B is used for each transmit packet, so 1k packets are supported max (probably go for 512 per CTM in fact, to provide space in the CTM for other stuff in the future? With the batch mechanism there is already 'fairness' to a great degree. So credit can be global for a CTM.</p>
<p>For 40GbE 64B packets there are 60Mpps, or 7.5Mpps for each of the eight 'batch'es.</p>
<p>The CPP latency budget for a thread loop (64B packet) can then be: MU work q (250 cycles) CTM credit (150 cycles) Packet alloc (100 cycles) CTM DMA (500 cycles) Read script (250 cycles) Write header (100 cycles) Overwrite DMA data (150 cycles, with readback to ensure order) Packet tx (0 cycles, no signal) Total of 1,500 cycles of latency</p>
<p>For processing Add to work q (10 cycles) CTM credit (30 cycles) Alloc (20 cycles) CTM DMA (30 cycles) Read script (10 cycles) Write header (20 cycles) Wait for DMA completion (10 cycles) Overwrite DMA data (30 cycles) Wait time (20 cycles) Tx sequence (20 cycles) Total 200 cycles</p>
<p>With this utilization we have ~200 ME instruction cycles out of ~1700 total cycles, with 8 threads. So an ME would achieve 8 packets (using 8 threads) every 1700 cycles, or 4.7Mpps Hence two MEs could accomplish a batch performance target of 7.5Mpps at 80% utilization</p>
<p>Note that the CTM DMA latency is likely to be a bottleneck, as threads will not be able to all overlap. So peak ME utilization may only be 50% cycles?</p>
<p>Also note that the above includes a simple 'null' script concept (presumably script is a simple overwrite of the header). If an interpreted script is used then more ME cycles will be consumed.</p>
<p>This points to a need for more than two MEs per batch, perhaps as many as four MEs. This would consume most of three ME islands for all 8 batches. Note then that a batch has 32 packets being processed simultaneously.</p>
<p>A script needs a type (fixed at present) and data fields</p>
<p>For a TCP flow we need to change dest Eth, dest IP, and TCP ports Possibly we need to change D/S Eth (12 bytes), S/D IP (8 bytes), TCP ports (4 bytes) One way to do this is two mem writes, with 24 bytes of data Further one may want to add to the IPv4 checksum (assuming the checksum ignores the S/D IP). Also the TCP checksum. The checksum updates require a read, add (16 bit), carry in, and write</p>
<p>We probably also need an 'encapsulate in VXLAN' mode, or option to achieve this. This would require a new Eth D/S, some fixed IP header fields, an IP length write, UDP SP, UDP length, VXLAN header (8B). This is a prepend of 44B with two length field writes.</p>
<p>So a script should be 64B of dataIncludesDefines </p>

</div>
</div>
<a class="anchor" id="a1785206ad78ce27528d134fc0b953652"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PKTS_IN_PROGRESS&#160;&#160;&#160;(32)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_master_distribute_schedule - to do - manage backup The batches are credit-managed</p>
<p>Probably need to do a number of batch_works at the same time to get the rate up, since each batch work is 8 packets</p>
<p>A burst of 4 at one time would be good. </p>

</div>
</div>
<a class="anchor" id="aa632d755a4f99e310c6f057c5af93227"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PKTGEN_CLS_HOST_ADDRESS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Memory declarations </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6c74505d381281a7046646fd366f788d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__declspec </td>
          <td>(</td>
          <td class="paramtype">shared&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Statics tx_slave_get_pkt_in_batch 10i + 150 </p>

</div>
</div>
<a class="anchor" id="ac2033c71b36de0b0da2992b38b86af72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_alloc_mem </td>
          <td>(</td>
          <td class="paramtype">&quot;pktgen_cls_debug_res cls island 64 64&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>struct <a class="el" href="structhost__data.html">host_data</a> </p>

</div>
</div>
<a class="anchor" id="a008f7e575456583ff8bb94fe667157f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void batch_dist_add_pkt_to_batch </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbatch__work.html">batch_work</a> *&#160;</td>
          <td class="paramname"><em>batch_work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xread struct pktgen_sched_entry *&#160;</td>
          <td class="paramname"><em>sched_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xwrite struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *&#160;</td>
          <td class="paramname"><em>tx_pkt_work_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SIGNAL *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>batch_dist_add_pkt_to_batch </p>

</div>
</div>
<a class="anchor" id="a55bb011c6b0189b120d7ae547f89d307"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void batch_dist_distribute_sched_entries </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbatch__work.html">batch_work</a> *&#160;</td>
          <td class="paramname"><em>batch_work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xread struct pktgen_sched_entry&#160;</td>
          <td class="paramname"><em>sched_entries</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>batch_dist_distribute_sched_entries </p>

</div>
</div>
<a class="anchor" id="aceb2375c2877e4eb5b842b6043d5ce2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void batch_dist_get_batch_work </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbatch__work.html">batch_work</a> *&#160;</td>
          <td class="paramname"><em>batch_work</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>batch_dist_get_batch_work </p>

</div>
</div>
<a class="anchor" id="a86003c48e3ec4169a8899e8945dcbdb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void batch_dist_get_sched_entries </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbatch__work.html">batch_work</a> *&#160;</td>
          <td class="paramname"><em>batch_work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xread struct pktgen_sched_entry&#160;</td>
          <td class="paramname"><em>sched_entries</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>batch_dist_get_sched_entries </p>

</div>
</div>
<a class="anchor" id="a39e056ba602dcac1e065468a1cd62d97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_batch_distributor </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_batch_distributor</p>
<p>A master consumes batch work</p>
<p>It generates 8 packets for the tx slaves (one per batch).</p>
<p>The work in is 16B:</p>
<p>a 32-bit packet-flow entry offset a 16-bit batch sequence (same for all 8 batches) a 16-bit transmit sequence (for the Tx orderer) a 4-bit number of valid packets a 40-bit base time.</p>
<p>It reads eight packet-flow entries at a time (128B) </p>

</div>
</div>
<a class="anchor" id="a3e2c22e9b35c5f7082268fcc50da8523"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_batch_distributor_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_batch_distributor_init </p>

</div>
</div>
<a class="anchor" id="ab4c6e320cf36a24808574a07e5d699c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_master </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_master</p>
<p>The master monitors the CLS and uses it to indicate that data is ready</p>
<p>MU base address for script (do not know how to distribute yet)</p>
<p>When started it distributes the work over the batch work queues </p>

</div>
</div>
<a class="anchor" id="a40b23f6d5b14315cbc8b9fe485b16d9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_master_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_master_init </p>

</div>
</div>
<a class="anchor" id="ac150555ef2cb8be4260d94c7b33a24e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_tx_slave </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_tx_slave 10i+150 + 6i+15 + ?i + 8i+300 + ?i + 4i+500 + ?i+150 + wait + 10i</p>
<p>= 34i + wait + read script start + write CTM pt hdr + overwrite DMA data</p>
<ul>
<li>1015 + wait </li>
</ul>

</div>
</div>
<a class="anchor" id="a75ad78e70b8a77076b4eddbfabf4870b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pktgen_tx_slave_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pktgen_tx_slave_init </p>

</div>
</div>
<a class="anchor" id="adad59556224ecabf28aa73f9c0755663"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void tx_master_add_batch_work </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbatch__work.html">batch_work</a> *&#160;</td>
          <td class="paramname"><em>batch_work</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_master_add_batch_work </p>

</div>
</div>
<a class="anchor" id="a500847c5a7c700fcce6c35b72c4dc1eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void tx_slave_dma_pkt_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *&#160;</td>
          <td class="paramname"><em>tx_pkt_work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *&#160;</td>
          <td class="paramname"><em>ctm_pkt_desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SIGNAL *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_dma_pkt_start</p>
<p>DMA packet from mu_base_s8&lt;&lt;8 + 64 to CTM packet + 64</p>
<p>The +64 permits the addition in CTM of the modification script etc</p>
<p>The +64 on both permits the overflow of the packet from CTM to MU if &gt;192B</p>
<p>Length to DMA is 64B for &lt;=64B packets, 128B for 65-128B packets, and 192B for &gt;128B packets </p>

</div>
</div>
<a class="anchor" id="aec85d5f9d2e8c647391fdbbe290b874e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void tx_slave_read_script_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *&#160;</td>
          <td class="paramname"><em>tx_pkt_work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xread struct <a class="el" href="structscript.html">script</a> *&#160;</td>
          <td class="paramname"><em>script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SIGNAL *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_read_script_start </p>

</div>
</div>
<a class="anchor" id="a69554b8c1126bf1d6de052cb135ad688"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tx_slave_script_finish </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structctm__pkt__desc.html">ctm_pkt_desc</a> *&#160;</td>
          <td class="paramname"><em>ctm_pkt_desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xwrite struct <a class="el" href="structscript__finish.html">script_finish</a> *&#160;</td>
          <td class="paramname"><em>script_finish</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_script_finish Start the script, and keep anything for the finish in <a class="el" href="structscript__finish.html">script_finish</a> </p>

</div>
</div>
<a class="anchor" id="af69f9e3d755de60c1a7bba51e3dfa5e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__intrinsic void tx_slave_script_start_write_hdr </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pkt_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xwrite uint32_t *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xwrite uint32_t *&#160;</td>
          <td class="paramname"><em>mod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_script_start Start the script, and keep anything for the finish in <a class="el" href="structscript__finish.html">script_finish</a> After this call 'script' will be disposed of </p>

</div>
</div>
<a class="anchor" id="af7640d85c7685a7c0f86f10bbea0d2b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tx_slave_wait_for_tx_time </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtx__pkt__work.html">tx_pkt_work</a> *&#160;</td>
          <td class="paramname"><em>tx_pkt_work</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>tx_slave_wait_for_tx_time Wait until tx_pkt_work-&gt;tx_time_lo/hi</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structtx__pkt__work.html">tx_pkt_work</a></td><td>Transmit packet work item to wait for </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 20 2016 15:36:17 for NFP Example Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
